<!DOCTYPE html>
<html lang="en">

<head>
  <!-- <meta http-equiv="Content-Security-Policy"
        content="default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'"> -->
  <style type="text/css" media="screen">
    #editor {
      height: 90vh;
      width: 90vw;
    }
  </style>

  <link href="./styles.css" rel="stylesheet">
  <title>RISC_VS_US</title>

</head>

<body style="background:#04090e; ">
  <div style="display: none;">
    <div style="
                    height: 7vh;
                    flex: 1;
                    background: #0F2F47;
                    display: flex;
                    justify-content: center;
                    align-items:center;
                    color: white;
                    font-size: 25px;
                  ">
      Nav Bar
    </div>

    <button class="button1" type="button" id="saveButton" >Save</button>
    <button class="button1" type="button" id="runButton">Run</button>
    <button class="button1" type="button" id="runcButton">Runc</button>
    <button class="button1" type="button" id="runvButton">Runv</button>
    <button class="button1" type="button" id="clearButton" onclick="clear_file()">Clear</button>
    <button class="button1" type="button" id="sendButton">Send</button>
  </div>
  <div style="height: 90vh; display: flex;">

    <div  style="width: 50vw;">
      <div id="display" style="
                  height: 30vh;
                  flex: 1;
                  background: #1F1B18;
                  display: flex;
                  justify-content: center;
                  align-items: center;
                  color: white;
                  font-size: 32px;
                ">
      </div>
      
      <div id="terminal" style="
                        height: 30vh;
                        flex: 1;
                        background-color: #404040;
                        display: flex;
                        color: white;
                        flex-direction: column;
                        overflow-y:scroll;
                        border-radius: 5px;
                      ">
        <div class="trml" id="current">
            <p class="arrow">>></p>
            <input type="text" id="cmd"></input>
            <p class="output" id="output"></p>
        </div>
    </div>
      <div style="
                      height: 30vh;
                      background: black;
                      justify-content: center;
                      align-items: center;
                      color: white;
                      font-size: 64px;
                      padding-top: 1vh;
                    ">
        <div style="display: flex; margin-right: 5px;">
          <button class="button3" onclick="toTerminal(event)">1</button>
          <button class="button2" onclick="toTerminal(event)">a</button>
          <button class="button2" onclick="toTerminal(event)">b</button>
          <button class="button2" onclick="toTerminal(event)">c</button>
          <button class="button2" onclick="toTerminal(event)">d</button>
          <button class="button2" onclick="toTerminal(event)">e</button>
          <button class="button2" onclick="toTerminal(event)">f</button>
          <button class="button2" onclick="toTerminal(event)">g</button>
          <button class="button2" onclick="toTerminal(event)">h</button>
          <button class="button2" onclick="toTerminal(event)">i</button>
          <button class="button2" onclick="toTerminal(event)">j</button>
        </div>
        <div style="display: flex; margin-right: 5px;">
          <button class="button3" onclick="toTerminal(event)">2</button>
          <button class="button3" onclick="toTerminal(event)">3</button>
          <button class="button2" onclick="toTerminal(event)">k</button>
          <button class="button2" onclick="toTerminal(event)">l</button>
          <button class="button2" onclick="toTerminal(event)">m</button>
          <button class="button2" onclick="toTerminal(event)">n</button>
          <button class="button2" onclick="toTerminal(event)">o</button>
          <button class="button2" onclick="toTerminal(event)">p</button>
          <button class="button2" onclick="toTerminal(event)">q</button>
          <button class="button2" onclick="toTerminal(event)">r</button>
          <button class="button2" onclick="toTerminal(event)">s</button>
        </div>
        <div style="display: flex; margin-right: 5px;">
          <button class="button3" onclick="toTerminal(event)">4</button>
          <button class="button3" onclick="toTerminal(event)">5</button>
          <button class="button3" onclick="toTerminal(event)">6</button>
          <button class="button2" onclick="toTerminal(event)">t</button>
          <button class="button2" onclick="toTerminal(event)">u</button>
          <button class="button2" onclick="toTerminal(event)">v</button>
          <button class="button2" onclick="toTerminal(event)">w</button>
          <button class="button2" onclick="toTerminal(event)">x</button>
          <button class="button2" onclick="toTerminal(event)">y</button>
          <button class="button2" onclick="toTerminal(event)">z</button>
          <button class="button6" onclick="toTerminal(event)">.</button>
        </div>
        <div style="display: flex; margin-right: 5px;">
          <button class="button3" onclick="toTerminal(event)">7</button>
          <button class="button3" onclick="toTerminal(event)">8</button>
          <button class="button3" onclick="toTerminal(event)">9</button>
          <button class="button3" onclick="toTerminal(event)">0</button>
          <button class="button4" onclick="toTerminal(event)">Space</button>
          <button class="button5">Enter</button>
          <button class="button6" onclick="toTerminal(event)">/</button>
        </div>
      </div>
    </div>
    <div id="editor">int main(){
  /*Write your code here*/
  return -1;
}</div>
  </div>
  <script src="./Text-Editor/ace.js" type="text/javascript" charset="utf-8"></script>
  <script src="./Text-Editor/editor_functions.js" type="text/javascript" charset="utf-8"></script>
  <input type="hidden" name="hiddenCodeWriter" style="display: none;" id="hiddenCodeWriter">
  <input type="hidden" name="hiddenDisplay" style="display: none;" id="hiddenDisplay">
  <input type="hidden" name="hiddenIp" style="display: none;" id="hiddenIp">
  <script>
    var editor = ace.edit('editor');
    editor.setTheme('ace/theme/cobalt');
    editor.session.setMode('ace/mode/c_cpp');
    editor.getSession().on("change", function () {
    let code = document.getElementById('hiddenCodeWriter');
        code.value = editor.getSession().getValue();
    });
  </script>
  <script>
    var input = document.getElementById("cmd");
    input.addEventListener("keyup", function (e) {
      if (e.keyCode === 13) {  
        var parent=document.getElementById("terminal");

        var container=document.createElement("div");
        container.classList.add("trml");

        var arrow=document.createElement("p");
        arrow.classList.add("arrow");
        arrow.innerHTML=">>";
        container.append(arrow);
        
        var inputfield=document.createElement("input");
        inputfield.type="text";
        inputfield.disabled=true;
        inputfield.value=input.value;
        container.append(inputfield);
        
        var pout=document.createElement("p");
        pout.classList.add("output");
        container.append(pout);

        var last=document.getElementById("current");
        last.parentNode.removeChild(last);
        parent.append(container);
        parent.append(last);
        var user_cmd = input.value;

        if(user_cmd==="save")
        {
          input.value="";
          pout.innerHTML="Saved Successfully";
          var button=document.getElementById("saveButton");
          button.click();
        }
        else if(user_cmd=="run")
        {
          input.value="";
          pout.innerHTML="Command Succesfully executed";
          var button=document.getElementById("runButton");
          button.click();
        }
        else if(user_cmd=="run -c")
        {
          input.value="";
          pout.innerHTML="Command Succesfully executed";
          var button=document.getElementById("runcButton");
          button.click();
        }
        else if(user_cmd=="run -v")
        {
          input.value="";
          pout.innerHTML="Command Succesfully executed";
          var button=document.getElementById("runvButton");
          button.click();
        }
        else if(user_cmd=="clear")
        {
          input.value="";
          pout.innerHTML="Successfully cleared the file";
          var button=document.getElementById("clearButton");
          button.click();
        }else if(user_cmd.startsWith('send')){
          input.value = "";
          var ip = user_cmd.split(' ')[1];
          let ipHtml = document.getElementById('hiddenIp');
          ipHtml.value = ip;
          pout.innerHTML="File send Successfully";
          var button=document.getElementById("sendButton");
          button.click();
        }
        else
        {
          input.value="";
          pout.innerHTML="Invalid command";
        }
      }
  });
  </script>
  <script>
    function toTerminal(event)
    {
      var input=document.getElementById("cmd");
      var elem=event.path[0].innerHTML;
      if(elem=="Space"){elem=" ";}
      input.value=input.value+elem;
    }
  </script>
  <script src="./Virtual_Display/initialise.js" type="text/javascript" charset="utf-8"></script>
</body>

</html>
